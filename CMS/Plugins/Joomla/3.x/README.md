## Модуль интеграции с CMS Joomla 3.x (с корзиной Joomshopping 4.x)

Данный модуль обеспечивает взаимодействие между интернет-магазином на базе CMS Joomla и сервисом платежей [ХуткiГрош](https://hutkigrosh.by)
  
### Инструкция по установке:
1. Создайте резервную копию вашего магазина и базы данных
2. Загрузите архив с модулем [hg_joom_shopping_install.zip](https://github.com/esasby/hgrosh/blob/master/CMS/Plugins/Joomla/3.x/hg_joom_shopping_install.zip)
3. В административной части Joomla выберите `Компоненты — JoomShopping — Установка и Обновление — Загрузка Файла`. Выберите архив и нажмите `Загрузить`.
4. Перейдите в меню `Компоненты — JoomShopping - Опции - Способы оплаты`.
5. Выберите HutkiGrosh, перейдите на вкладку "Конфигурация"
6. Заполните параметры для идентификации вашего магазина в системе ХуткiГрош
    * Режим песочницы - перевод модуля в тестовый режим работы
    * Название магазина - произволное название Вашего магазина 
    * Уникальный идентификатор услуги ЕРИП – ID услуги в ЕРИП
    * Логин – логин в системе ХуткiГрош.
    * Пароль – пароль в системе ХуткiГрош.
    * Sms оповещение - включить информирование клиента по смс при успешном выставлении счета (выполняется шлюзом Хуткiгрош)
    * Email оповещение - включить информирование клиента по email при успешном выставлении счета (выполняется шлюзом Хуткiгрош)
    * Статус заказа, если произошла ошибка выставления счета - какой статус присвоить заказу, если произошла ошибка выставления счета
    в ХуткiГрош  
    * Статус заказа, если счет выставлен в ЕРИП  - какой статус присвоить заказу, если счет успешно выставлен в ХуткiГрош
    * Статус заказа, если счет оплачен в ЕРИП - какой статус присвоить заказу, когда ХуткiГрош проинформировал CMS о том,
    что счет успешно оплачен в ЕРИП
    * Статус заказа, если счет отменен в ЕРИП - какой статус присвоить заказу, когда ХуткiГрош проинформировал CMS о том,
    что счет по какой-то причине отменен в ЕРИП в ЕРИП           
7. Сохраните изменения.
8. Для редактирования текста, отображаемого клиенту после успешного выставления счета, необходимо перейти в `Компоненты — JoomShopping - Конфигурация - Статический текст`. И отредактировать текст для `order_hg_completion_text` (может содержать html, в переменной @order_number будет номер заказа)


### Внимание!
Для автоматического обновления статуса заказа (после оплаты клиентом выставленного в ЕРИП счета) необходимо сообщить в службу технической поддержки сервиса «Хуткi Грош» адрес обработчика:
```
http://mydomen.my/index.php?option=com_jshopping&controller=hutkigrosh&task=notify
```

### Тестовые данные
Для настрой оплаты в тестовом режиме:
 * воспользуйтесь данными для подключения к тестовой системе, полученными при регистрации в ХуткiГрош
 * включите в настройках модуля "Режим песочницы" 
 * для эмуляции оплаты клиентом выставленного счета воспльзуйтесь личным кабинетом [тестовой системы](https://trial.hgrosh.by) (меню _Тест оплаты ЕРИП_)

_Разработано и протестировано с Joomla v.3.8.3 + Commerce v.4.16.3_
